# SECURITY.md

**Rarog — Политика безопасности**

Этот документ описывает, как сообщать об уязвимостях, как мы их обрабатываем и какие меры предпринимаются для защиты пользователей и пользователей Rarog. Проект — с открытым исходным кодом под лицензией Apache‑2.0. Автор: TheSkiF4er.

---

## Кому сообщать

Если вы обнаружили уязвимость, пожалуйста, сообщите нам приватно, не раскрывая проблему публично до её исправления.

* **Предпочтительный канал:** GitHub Security Advisories (в репозитории `TheSkiF4er/rarog`) — создайте приватное advisory.
* **Альтернативно:** письмо на адрес **[security@cajeer.ru](mailto:security@cajeer.ru)**. При отправке письма укажите в теме: `SECURITY REPORT — [краткое описание]`.

> Не размещайте подробное техническое описание уязвимости в публичных issue или обсуждениях — это позволяет злоумышленникам эксплуатировать проблему до её исправления.

---

## Что включать в отчёт

Чтобы ускорить обработку, пожалуйста, включите следующие элементы:

1. Краткое описание уязвимости (тип: XSS, CSRF, RCE, SSRF, информационная утечка, уязвимость конфиденциальности и т.д.).
2. Уязвимые версии/компоненты (например: `@rarog/core <= 0.1.3`).
3. Шаги для воспроизведения (POC) — минимальный пример, желателен в виде кода/серии команд. Если возможно, предоставьте POC в изолированной среде. Для приватных данных используйте зашифрованные вложения.
4. Ожидаемое и фактическое поведение.
5. Влияние: потенциальные риски и рекомендации по минимизации.
6. Предложение по исправлению (если у вас есть идея).
7. Ваши контакты (email, опционально PGP ключ) и готовы ли вы помочь с тестированием исправления.

---

## Процесс обработки уязвимости

1. **Подтверждение получения:** в течение 48 часов мы подтверждаем получение сообщения и даём ориентировочный план действий. Если подтверждения нет — напишите повторно или используйте альтернативный канал.
2. **Триаж:** команда безопасности оценивает воздействие и приоритет, назначает ответственного. Срок — до 7 дней для первоначальной оценки.
3. **Разработка патча:** для подтверждённых проблем мы создаём приватную ветку/PR с исправлением. Если исправление влияет на API, мы готовим инструкцию по миграции.
4. **Тестирование:** запускаются unit, integration и A11Y тесты, а также security scan (SAST/DAST) и, при необходимости, ручная валидация.
5. **Релиз:** после проверки выпускается исправление и security advisory (с указанием CVE, если применимо). Мы стараемся выпускать срочные патчи в течение 30 дней для критических проблем.
6. **Публичное раскрытие:** после выпуска исправления мы публикуем уведомление и техническое описание уязвимости, заранее согласовывая текст с исследователем (если он участвует).

---

## SLA и ожидания

* Подтверждение получения: **≤ 48 часов**.
* Первичная оценка (triage): **≤ 7 дней**.
* Исправление для критических уязвимостей: **в идеале ≤ 30 дней**; для менее критичных — в зависимости от приоритета и релизного цикла.
* Мы используем классификацию критичности по CVSS как ориентацию, но приоритет выставляется с учётом контекста использования.

Если срок не соблюдается, сообщите повторно (иногда письма теряются в спаме).

---

## Классификация уязвимостей (примерная)

* **Критическая:** удалённое выполнение кода (RCE), утечка секретов, обход аутентификации, которые легко эксплуатировать и приводят к компрометации системы — *требует срочного исправления*.
* **Высокая:** привилегированное воздействие, SQL/NoSQL инъекции, важные XSS/CSRF, подмена контента.
* **Средняя:** локальные уязвимости, сложности эксплуатации, общее снижение конфиденциальности/интегритета.
* **Низкая:** информационные утечки с низким воздействием, minor misconfig, косметические баги.

---

## Награды и признание

* Rarog — open source проект, текущая политика: **непредусмотрение денежной награды** по умолчанию. Мы всегда готовы публично признать вклад исследователей (если они согласны).
* Для корпоративных проектов или партнёров возможна отдельная программа баг баунти — обсуждается индивидуально.

---

## Раскрытие и CVE

Мы регистрируем CVE для подтверждённых уязвимостей, которые соответствуют критериям для публикации. Обычно CVE присваивается после того, как исправление выпущено и advisory опубликовано.

---

## Работа с зависимостями

* Мы регулярно выполняем автоматические сканирования зависимостей (Dependabot / Renovate) и просматриваем security alerts на GitHub.
* Рекомендуем использовать зафиксированные версии и публиковать инструкции по обновлению зависимостей в release notes.

---

## CI/CD и сканирование образов

* Образ CI должен включать SAST (например, SonarQube), dependency scanning (Snyk/Dependabot), и контейнерное сканирование (Trivy).
* Docker images — сканируются перед пушем в реестр, в CI/PR пайплайне запрещён push уязвимых образов (policy gate).

---

## Утечка секретов и срочные инциденты

Если вы предполагаете, что секрет (ключ API, токен доступа) был скомпрометирован в результате уязвимости — сообщите немедленно. Мы можем инициировать срочную ротацию ключей и выпустить инструкции по безопасной миграции.

При инциденте: пометьте письмо как `URGENT` и укажите возможный объём компрометации.

---

## Как мы работаем с информацией исследователей

* Мы публикуем благодарности (если исследователь согласен): `SECURITY.md` или `AUTHORS_SECURITY.md` / `HALL_OF_FAME`.
* Если исследователь пожелал анонимность — мы её уважаем.

---

## Контакты и PGP

* Email для безопасности: **[security@cajeer.ru](mailto:security@cajeer.ru)**.
* Мы поддерживаем обмен зашифрованными сообщениями по PGP — отправьте нам ваш публичный ключ, и мы предоставим наш PGP ключ при запросе.

---

## Best practices для пользователей Rarog

* Всегда используйте последнюю стабильную версию пакета.
* Подписывайте релизы и проверяйте подписи (если применимо).
* Не храните секреты в репозитории; используйте secret‑management решения (Vault, GitHub Secrets, External Secrets).
* Настройте Dependabot/renovate и автоматическое тестирование обновлений в CI.

---

## Примечания для разработчиков/поддержки проекта

* При получении репорта создайте приватный issue и ссылку на security advisory.
* Отслеживайте работу через labels: `security/triage`, `security/patching`, `security/review`, `security/released`.
* Обновляйте `CHANGELOG` с пометкой `security` и версией, в которой баг исправлен.
* Обеспечьте автоматические тесты для проверки исправления (unit/integration/e2e).

---

Спасибо за помощь в улучшении безопасности Rarog. Мы ценим вклад сообщества и стремимся к прозрачной, быстрой и честной обработке уязвимостей.
